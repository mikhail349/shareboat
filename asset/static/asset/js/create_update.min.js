function CreateUpdate(){function a(a){const b=a?{enabled:!0,caption:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"}:{enabled:!1,caption:"\u0421\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u0435..."};r(b)}async function b(a){let b=[...k];const c=await axios.get(`/file/api/get_assetfiles/${a}/`);for(let d of c.data.data){let a=await fetch(d.url),c=await a.blob();c.filename=d.filename,b.push({blob:c,url:URL.createObjectURL(c)})}l(b)}async function c(a){const b=[...k];for(let c of a)b.push({blob:c,url:URL.createObjectURL(c)});l(b)}async function d(b){const c=new FormData;c.append("name",m.name);for(let a of k)c.append("file",a.blob,a.blob.filename);a(!1);try{const a=await axios.post(b,c);window.location.href=a.data.redirect}catch(b){window.scrollTo(0,0),h(b.response.data.message),a(!0)}}function e(a){let b=[...k];URL.revokeObjectURL(b[a].url),b.splice(a,1),l(b)}function f(){return 0<o}const[g,h]=React.useState(),[i,j]=React.useState(),[k,l]=React.useState([]),[m,n]=React.useState(),[o,p]=React.useState(0),[q,r]=React.useState({enabled:!0,caption:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"}),s=React.createRef(),t=React.useRef();return React.useEffect(()=>{axios.defaults.xsrfCookieName="csrftoken",axios.defaults.xsrfHeaderName="X-CSRFToken";const a=window.asset?1:0;return n(window.asset),j(a),1==a&&b(window.asset.id),()=>{for(let a of k)URL.revokeObjectURL(a.url)}},[]),/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("form",{ref:t,onSubmit:function(a){a.preventDefault(),h(),0==i?d("/asset/api/create/"):d(`/asset/api/update/${m.id}/`)},className:"needs-validation",noValidate:!0},g&&/*#__PURE__*/React.createElement("div",{className:"alert alert-danger"},g),/*#__PURE__*/React.createElement("div",{className:"mb-3"},/*#__PURE__*/React.createElement("label",{for:"name"},"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0430\u043A\u0442\u0438\u0432\u0430"),/*#__PURE__*/React.createElement("input",{type:"text",id:"name",name:"name",className:"form-control",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0430\u043A\u0442\u0438\u0432\u0430",autocomplete:"false","aria-describedby":"invalidInputName",required:!0,value:m&&m.name,onChange:function(a){n(b=>{const c={...b,name:a.target.value};return c})}}),/*#__PURE__*/React.createElement("div",{id:"invalidInputName",class:"invalid-feedback"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0430\u043A\u0442\u0438\u0432\u0430")),/*#__PURE__*/React.createElement("div",{className:"mb-3"},/*#__PURE__*/React.createElement("h4",{className:"mb-3"},"\u0424\u043E\u0442\u043E\u0433\u0440\u0430\u0444\u0438\u0438"),/*#__PURE__*/React.createElement("div",{className:`file-upload-wrapper ${f()?"bg-light":""}`,onDragEnter:function(a){a.preventDefault(),p(a=>a+1)},onDragLeave:function(a){a.preventDefault(),p(a=>a-1)},onDrop:function(a){a.preventDefault(),p(0),c(a.dataTransfer.files)},onDragOver:a=>a.preventDefault()},/*#__PURE__*/React.createElement("div",{className:"row"},/*#__PURE__*/React.createElement("input",{ref:s,type:"file",name:"hidden_files",accept:"image/*",multiple:!0,hidden:!0,onChange:function(a){const b=[...a.target.files];c(b),s.current.value=null}}),k.map((a,b)=>/*#__PURE__*/React.createElement("div",{key:b,className:"col-md-3 mb-3"},/*#__PURE__*/React.createElement("div",{className:"card box-shadow text-end"},/*#__PURE__*/React.createElement("img",{src:a.url,className:"card-img"}),/*#__PURE__*/React.createElement("div",{className:"card-img-overlay"},/*#__PURE__*/React.createElement("div",{className:"btn-group"},/*#__PURE__*/React.createElement("button",{type:"button",onClick:()=>e(b),className:"btn btn-sm btn-danger"},"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"))))))),/*#__PURE__*/React.createElement("div",{class:"row align-items-center"},/*#__PURE__*/React.createElement("div",{class:"col-auto"},/*#__PURE__*/React.createElement("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>s.current.click()},"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C ",!!k.length&&"\u0435\u0449\u0451 ","\u0444\u043E\u0442\u043E")),/*#__PURE__*/React.createElement("div",{class:"col-auto"},f()?/*#__PURE__*/React.createElement("span",{className:"text-success"},"\u041E\u0442\u043F\u0443\u0441\u0442\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0444\u043E\u0442\u043E"):!window.isMobile()&&/*#__PURE__*/React.createElement("span",{className:"text-muted"},"\u0418\u043B\u0438 \u043F\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0444\u043E\u0442\u043E \u0441\u044E\u0434\u0430")))),/*#__PURE__*/React.createElement("hr",null),/*#__PURE__*/React.createElement("button",{type:"submit",className:"btn btn-outline-success",disabled:!q.enabled},q.caption))))}ReactDOM.render(/*#__PURE__*/React.createElement(CreateUpdate,null),document.querySelector("#react_app"));