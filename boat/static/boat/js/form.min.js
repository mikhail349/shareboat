$(document).ready(()=>{class a{constructor(a){this.input=a,this.tooltip=$(a).siblings(".invalid-tooltip"),this.errorsList=[]}addError(a,b){b(this.input.val())&&this.errorsList.push(a)}validate(){const a=this.errorsList.join("\n");this.input[0].setCustomValidity(a),this.tooltip.text(a)}}$("input[name=name]").on("input",()=>{const b=new a($("input[name=name]"));b.addError("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043B\u043E\u0434\u043A\u0438",a=>!a),b.addError("\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u0434\u043B\u0438\u043D\u043D\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",a=>255<a.length),b.validate()}),$("input[name=length]").on("input",()=>{const b=new a($("input[name=length]"));b.addError("\u0423\u043A\u0430\u0436\u0438\u0442\u0435 \u0434\u043B\u0438\u043D\u0443 \u043B\u043E\u0434\u043A\u0438",a=>!a||.1>a),b.addError("\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u0434\u043B\u0438\u043D\u043D\u0430\u044F \u043B\u043E\u0434\u043A\u0430",a=>999.9<a),b.validate()}),$("input[name=width]").on("input",()=>{const b=new a($("input[name=width]"));b.addError("\u0423\u043A\u0430\u0436\u0438\u0442\u0435 \u0448\u0438\u0440\u0438\u043D\u0443 \u043B\u043E\u0434\u043A\u0438",a=>!a||.1>a),b.addError("\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u0448\u0438\u0440\u043E\u043A\u0430\u044F \u043B\u043E\u0434\u043A\u0430",a=>99.9<a),b.validate()}),$("input[name=draft]").on("input",()=>{const b=new a($("input[name=draft]"));b.addError("\u0423\u043A\u0430\u0436\u0438\u0442\u0435 \u043E\u0441\u0430\u0434\u043A\u0443 \u043B\u043E\u0434\u043A\u0438",a=>!a||.1>a),b.addError("\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u0431\u043E\u043B\u044C\u0448\u0430\u044F \u043E\u0441\u0430\u0434\u043A\u0430",a=>9.9<a),b.validate()}),$("input[name=capacity]").on("input",()=>{const b=new a($("input[name=capacity]"));b.addError("\u0423\u043A\u0430\u0436\u0438\u0442\u0435 \u0432\u043C\u0435\u0441\u0442\u0438\u043C\u043E\u0441\u0442\u044C \u043B\u043E\u0434\u043A\u0438",a=>!a||0==a),b.addError("\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u0431\u043E\u043B\u044C\u0448\u0430\u044F \u0432\u043C\u0435\u0441\u0442\u0438\u043C\u043E\u0441\u0442\u044C \u043B\u043E\u0434\u043A\u0438",a=>99<a),b.validate()}),$("form").on("submit",async a=>{a.preventDefault();const b=$("form");if(!b.checkValidity())return;showOverlayPanel();const c=new FormData(b[0]),d=$(".file-upload-wrapper img.card-img");for(let b of d){const a=$(b),d=a.attr("src"),e=a.attr("data-filename"),f=await fetch(d),g=await f.blob();e?c.append("file",g,e):c.append("file",g),console.log(d)}const e=b.attr("action");$.ajax({type:"POST",data:c,url:e,processData:!1,contentType:!1,success:function(a){hideOverlayPanel(),window.location.href=a.redirect},error:function(a){console.log(a),hideOverlayPanel(),showErrorToast(a.responseJSON.message||a.data)}/*const form = $("#formProfile");
        if (!form.checkValidity()) return;

        const formData = new FormData(form[0]);

        if ($("img.avatar")[0].hasAttribute('data-do-save')) {
            let response = await fetch($("img.avatar").attr("src"));
            let data = await response.blob();
            formData.set("avatar", data, avatarName);
        }

        showOverlayPanel();
        $.ajax({ 
            type: "POST",
            data: formData,
            url: "/user/api/update/",
            processData: false,
            contentType: false,
            success: onSuccess,
            error: onError
        });
    
        function onSuccess(data, status) {
            hideOverlayPanel();
            showSuccessToast();
            const userName = $('input[name=first_name]').val()
            const email = $("#formProfile input[name=email]").val();
            $("#userNameNavBar").text(userName || email);
        }
    
        function onError(error) {
            hideOverlayPanel();
            showErrorToast(error.responseJSON.message);
        }*/})})});