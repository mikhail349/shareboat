$(document).ready(()=>{$("img.avatar").on("click",()=>{$("input[name=avatar]").trigger("click")});const a=$("img.avatar").attr("src");var b=a.replace(/^.*[\\\/]/,"");$("input[name=avatar]").on("change",a=>{if(a.target.files&&a.target.files[0]){var c=new FileReader;c.onload=a=>{$("img.avatar").attr("src",a.target.result),$("img.avatar").attr("data-do-save","true")},b=a.target.files[0].name,c.readAsDataURL(a.target.files[0])}}),$("#btnSendConfirmation").on("click",a=>{a.preventDefault();const b=$("#formProfile input[name=email]").val();showInfoToast(`Письмо с подтверждением отправлено на почту ${b}`)}),$("#formProfile").on("submit",async a=>{function c(){f.attr("disabled",!1),showSuccessToast();const a=$("input[name=first_name]").val(),b=$("#formProfile input[name=email]").val();$("#userNameNavBar").text(a||b)}function d(a){f.attr("disabled",!1),showErrorToast(a.responseJSON.message)}a.preventDefault();const e=$("#formProfile"),f=e.find("button[type=submit]");if(e.checkValidity()){const a=new FormData(e[0]);if($("img.avatar")[0].hasAttribute("data-do-save")){let c=await fetch($("img.avatar").attr("src")),d=await c.blob();a.set("avatar",d,b)}f.attr("disabled",!0),$.ajax({type:"POST",data:a,url:"/user/api/update/",processData:!1,contentType:!1,success:c,error:d})}})});