$(document).ready(()=>{$("img.avatar").on("click",()=>{$("input[name=avatar]").trigger("click")});const a=$("img.avatar").attr("src");var b=a.replace(/^.*[\\\/]/,"");$("input[name=avatar]").on("change",a=>{if(a.target.files&&a.target.files[0]){var c=new FileReader;c.onload=a=>{$("img.avatar").attr("src",a.target.result)},b=a.target.files[0].name,c.readAsDataURL(a.target.files[0])}}),$("#btnSendConfirmation").on("click",()=>{const a=$("#formProfile input[name=email]").val();showInfoToast(`Письмо с подтверждением отправлено на почту ${a}`)}),$("#formProfile").on("submit",async a=>{a.preventDefault();const c=$("#formProfile"),d=c.find("button[type=submit]");if(!c.checkValidity())return;const e=new FormData(c[0]);let f=await fetch($("img.avatar").attr("src")),g=await f.blob();e.set("avatar",g,b),d.attr("disabled",!0),$.ajax({type:"POST",data:e,//form.serialize(),
url:"/user/api/update/",processData:!1,contentType:!1,success:function(){d.attr("disabled",!1),showSuccessToast()},error:function(a){d.attr("disabled",!1),showErrorToast(a.responseJSON.message)}})})});